graph TB
    subgraph REDIS_DATABASE["Redis Database Structure"]
        subgraph PRODUCT_DATA["Product Data Storage"]
            subgraph ASIN_KEYS["ASIN Keys (Hash Structure)"]
                ASIN_KEY["ASIN_{asin}"]
                subgraph ASIN_FIELDS["Hash Fields"]
                    SELLER_SKU_FIELD["{seller_id}:{sku}"]
                    subgraph PRODUCT_JSON["Product JSON Value"]
                        PROD_listed_price["listed_price: float"]
                        PROD_min_price["min_price: float"]
                        PROD_max_price["max_price: float"]
                        PROD_default_price["default_price: float"]
                        PROD_strategy_id["strategy_id: string"]
                        PROD_status["status: Active|Inactive|Paused"]
                        PROD_item_condition["item_condition: New|Used|Collectible|Refurbished"]
                        PROD_quantity["quantity: int"]
                    end
                end
            end
        end
        
        subgraph STRATEGY_DATA["Strategy Data Storage"]
            subgraph STRATEGY_KEYS["Strategy Keys (Hash Structure)"]
                STRATEGY_KEY["strategy.{strategy_id}"]
                subgraph STRATEGY_FIELDS["Hash Fields"]
                    STRAT_type["type: LOWEST_PRICE|LOWEST_FBA_PRICE|MATCH_BUYBOX"]
                    STRAT_beat_by["beat_by: decimal string"]
                    STRAT_min_price_rule["min_price_rule: JUMP_TO_MIN|JUMP_TO_MAX|DO_NOTHING|DEFAULT_PRICE"]
                    STRAT_max_price_rule["max_price_rule: JUMP_TO_MIN|JUMP_TO_MAX|DO_NOTHING|DEFAULT_PRICE"]
                end
            end
        end
        
        subgraph CALCULATED_PRICES["Calculated Prices Storage"]
            subgraph CALC_KEYS["Calculated Price Keys (Hash Structure)"]
                CALC_KEY["CALCULATED_PRICES:{seller_id}"]
                subgraph CALC_FIELDS["Hash Fields"]
                    CALC_SKU_FIELD["{sku}"]
                    subgraph CALC_JSON["Calculated Price JSON Value"]
                        CALC_new_price["new_price: float"]
                        CALC_old_price["old_price: float"]
                        CALC_strategy_used["strategy_used: string"]
                        CALC_strategy_id["strategy_id: string"]
                        CALC_competitor_price["competitor_price: float"]
                        CALC_calculated_at["calculated_at: ISO datetime"]
                        CALC_processing_time["processing_time_ms: float"]
                    end
                end
                CALC_TTL["TTL: 2 hours (7200 seconds)"]
            end
        end
    end
    
    subgraph DATA_SOURCES["Data Population Sources"]
        subgraph MYSQL_POPULATION["MySQL Database Integration"]
            MYSQL_STRATEGIES["repricer_strategies table → strategy.{id}"]
            MYSQL_USERS["users table → seller ID mapping (uk_sellerId/us_sellerId)"]
            MYSQL_INVENTORY["inventory_<region> table → ASIN_{asin} with sellers"]
            MYSQL_SETTINGS["JSON settings field → strategy configuration"]
        end

    end
    
    subgraph DATA_TYPES["Redis Data Types & Structure"]
        HASH_TYPE["HASH - Primary storage type for all data"]
        JSON_VALUES["JSON Strings - Complex nested product/price data"]
        STRING_VALUES["String Values - Simple strategy configuration fields"]
        TTL_MECHANISM["TTL - Automatic 2-hour expiration for calculated prices"]
        
        subgraph CONNECTION_POOLING["Connection Management"]
            POOL_CONFIG["Connection Pool: max_connections=20, retry_on_timeout=True"]
            ASYNC_REDIS["Async Redis Client with decode_responses=True"]
            PIPELINE_SUPPORT["Pipeline support for bulk operations"]
        end
    end

    %% Key Relationships
    ASIN_KEY --> SELLER_SKU_FIELD
    SELLER_SKU_FIELD --> PRODUCT_JSON
    STRATEGY_KEY --> STRATEGY_FIELDS
    CALC_KEY --> CALC_SKU_FIELD
    CALC_SKU_FIELD --> CALC_JSON
    
    MYSQL_STRATEGIES --> STRATEGY_KEY
    MYSQL_INVENTORY --> ASIN_KEY
    MYSQL_USERS --> SELLER_SKU_FIELD